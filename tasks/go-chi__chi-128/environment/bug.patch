diff --git a/middleware/closenotify17.go b/middleware/closenotify_17.go
similarity index 100%
rename from middleware/closenotify17.go
rename to middleware/closenotify_17.go
diff --git a/middleware/compress.go b/middleware/compress.go
index 5515e1d..7a8ebf4 100644
--- a/middleware/compress.go
+++ b/middleware/compress.go
@@ -1,12 +1,9 @@
 package middleware
 
 import (
-	"bufio"
 	"compress/flate"
 	"compress/gzip"
-	"errors"
 	"io"
-	"net"
 	"net/http"
 	"strings"
 )
@@ -182,16 +179,9 @@ func (w *maybeCompressResponseWriter) Flush() {
 	}
 }
 
-func (w *maybeCompressResponseWriter) Hijack() (net.Conn, *bufio.ReadWriter, error) {
-	if hj, ok := w.w.(http.Hijacker); ok {
-		return hj.Hijack()
-	}
-	return nil, nil, errors.New("chi/middleware: http.Hijacker is unavailable on the writer")
-}
-
 func (w *maybeCompressResponseWriter) Close() error {
 	if c, ok := w.w.(io.WriteCloser); ok {
 		return c.Close()
 	}
-	return errors.New("chi/middleware: io.WriteCloser is unavailable on the writer")
+	return nil
 }
diff --git a/middleware/compress18.go b/middleware/compress18.go
deleted file mode 100644
index ad12b14..0000000
--- a/middleware/compress18.go
+++ /dev/null
@@ -1,15 +0,0 @@
-// +build go1.8
-
-package middleware
-
-import (
-	"errors"
-	"net/http"
-)
-
-func (w *maybeCompressResponseWriter) Push(target string, opts *http.PushOptions) error {
-	if ps, ok := w.w.(http.Pusher); ok {
-		return ps.Push(target, opts)
-	}
-	return errors.New("chi/middleware: http.Pusher is unavailable on the writer")
-}
diff --git a/middleware/logger.go b/middleware/logger.go
index 64e50b9..5b1eafe 100644
--- a/middleware/logger.go
+++ b/middleware/logger.go
@@ -29,7 +29,7 @@ func RequestLogger(f LogFormatter) func(next http.Handler) http.Handler {
 	return func(next http.Handler) http.Handler {
 		fn := func(w http.ResponseWriter, r *http.Request) {
 			entry := f.NewLogEntry(r)
-			ww := NewWrapResponseWriter(w, r.ProtoMajor)
+			ww := NewWrapResponseWriter(w)
 
 			t1 := time.Now()
 			defer func() {
diff --git a/middleware/middleware18_test.go b/middleware/middleware18_test.go
deleted file mode 100644
index 0a697ad..0000000
--- a/middleware/middleware18_test.go
+++ /dev/null
@@ -1,77 +0,0 @@
-// +build go1.8
-
-package middleware
-
-import (
-	"crypto/tls"
-	"io"
-	"net/http"
-	"testing"
-	"time"
-
-	"golang.org/x/net/http2"
-)
-
-// NOTE: we must import `golang.org/x/net/http2` in order to explicitly enable
-// http2 transports for certain tests. The runtime pkg does not have this dependency
-// though as the transport configuration happens under the hood on go 1.7+.
-
-func TestWrapWriterHTTP2(t *testing.T) {
-	handler := http.HandlerFunc(func(w http.ResponseWriter, r *http.Request) {
-		_, cn := w.(http.CloseNotifier)
-		if !cn {
-			t.Fatal("request should have been a http.CloseNotifier")
-		}
-		_, fl := w.(http.Flusher)
-		if !fl {
-			t.Fatal("request should have been a http.Flusher")
-		}
-		_, hj := w.(http.Hijacker)
-		if hj {
-			t.Fatal("request should not have been a http.Hijacker")
-		}
-		_, rf := w.(io.ReaderFrom)
-		if rf {
-			t.Fatal("request should not have been a io.ReaderFrom")
-		}
-		_, ps := w.(http.Pusher)
-		if !ps {
-			t.Fatal("request should have been a http.Pusher")
-		}
-
-		w.Write([]byte("OK"))
-	})
-
-	wmw := func(next http.Handler) http.Handler {
-		return http.HandlerFunc(func(w http.ResponseWriter, r *http.Request) {
-			next.ServeHTTP(NewWrapResponseWriter(w, r.ProtoMajor), r)
-		})
-	}
-
-	server := http.Server{
-		Addr:    ":7072",
-		Handler: wmw(handler),
-	}
-	// By serving over TLS, we get HTTP2 requests
-	go server.ListenAndServeTLS(testdataDir+"/cert.pem", testdataDir+"/key.pem")
-	defer server.Close()
-	// We need the server to start before making the request
-	time.Sleep(100 * time.Millisecond)
-
-	client := &http.Client{
-		Transport: &http2.Transport{
-			TLSClientConfig: &tls.Config{
-				// The certificates we are using are self signed
-				InsecureSkipVerify: true,
-			},
-		},
-	}
-
-	resp, err := client.Get("https://localhost:7072")
-	if err != nil {
-		t.Fatalf("could not get server: %v", err)
-	}
-	if resp.StatusCode != 200 {
-		t.Fatalf("non 200 response: %v", resp.StatusCode)
-	}
-}
diff --git a/middleware/middleware_test.go b/middleware/middleware_test.go
index 1c0925d..3a516d2 100644
--- a/middleware/middleware_test.go
+++ b/middleware/middleware_test.go
@@ -5,23 +5,10 @@ import (
 	"io/ioutil"
 	"net/http"
 	"net/http/httptest"
-	"path"
 	"reflect"
-	"runtime"
 	"testing"
 )
 
-// NOTE: we must import `golang.org/x/net/http2` in order to explicitly enable
-// http2 transports for certain tests. The runtime pkg does not have this dependency
-// though as the transport configuration happens under the hood on go 1.7+.
-
-var testdataDir string
-
-func init() {
-	_, filename, _, _ := runtime.Caller(0)
-	testdataDir = path.Join(path.Dir(filename), "/../testdata")
-}
-
 func testRequest(t *testing.T, ts *httptest.Server, method, path string, body io.Reader) (int, string) {
 	req, err := http.NewRequest(method, ts.URL+path, body)
 	if err != nil {
diff --git a/middleware/wrap_writer.go b/middleware/wrap_writer.go
index 9991736..19edcb9 100644
--- a/middleware/wrap_writer.go
+++ b/middleware/wrap_writer.go
@@ -10,6 +10,8 @@ import (
 	"net/http"
 )
 
+var WrapResponseWriterCtxKey = &contextKey{"WrapResponseWriter"}
+
 // WrapResponseWriter is a proxy around an http.ResponseWriter that allows you to hook
 // into various parts of the response process.
 type WrapResponseWriter interface {
@@ -30,6 +32,24 @@ type WrapResponseWriter interface {
 	Unwrap() http.ResponseWriter
 }
 
+// NewWrapResponseWriter wraps an http.ResponseWriter, returning a proxy that allows you to
+// hook into various parts of the response process.
+func NewWrapResponseWriter(w http.ResponseWriter) WrapResponseWriter {
+	_, cn := w.(http.CloseNotifier)
+	_, fl := w.(http.Flusher)
+	_, hj := w.(http.Hijacker)
+	_, rf := w.(io.ReaderFrom)
+
+	bw := basicWriter{ResponseWriter: w}
+	if cn && fl && hj && rf {
+		return &fancyWriter{bw}
+	}
+	if fl {
+		return &flushWriter{bw}
+	}
+	return &bw
+}
+
 // basicWriter wraps a http.ResponseWriter that implements the minimal
 // http.ResponseWriter interface.
 type basicWriter struct {
@@ -78,38 +98,27 @@ func (b *basicWriter) Unwrap() http.ResponseWriter {
 	return b.ResponseWriter
 }
 
-type flushWriter struct {
-	basicWriter
-}
-
-func (f *flushWriter) Flush() {
-	fl := f.basicWriter.ResponseWriter.(http.Flusher)
-	fl.Flush()
-}
-
-var _ http.Flusher = &flushWriter{}
-
-// httpFancyWriter is a HTTP writer that additionally satisfies http.CloseNotifier,
+// fancyWriter is a writer that additionally satisfies http.CloseNotifier,
 // http.Flusher, http.Hijacker, and io.ReaderFrom. It exists for the common case
 // of wrapping the http.ResponseWriter that package http gives you, in order to
 // make the proxied object support the full method set of the proxied object.
-type httpFancyWriter struct {
+type fancyWriter struct {
 	basicWriter
 }
 
-func (f *httpFancyWriter) CloseNotify() <-chan bool {
+func (f *fancyWriter) CloseNotify() <-chan bool {
 	cn := f.basicWriter.ResponseWriter.(http.CloseNotifier)
 	return cn.CloseNotify()
 }
-func (f *httpFancyWriter) Flush() {
+func (f *fancyWriter) Flush() {
 	fl := f.basicWriter.ResponseWriter.(http.Flusher)
 	fl.Flush()
 }
-func (f *httpFancyWriter) Hijack() (net.Conn, *bufio.ReadWriter, error) {
+func (f *fancyWriter) Hijack() (net.Conn, *bufio.ReadWriter, error) {
 	hj := f.basicWriter.ResponseWriter.(http.Hijacker)
 	return hj.Hijack()
 }
-func (f *httpFancyWriter) ReadFrom(r io.Reader) (int64, error) {
+func (f *fancyWriter) ReadFrom(r io.Reader) (int64, error) {
 	if f.basicWriter.tee != nil {
 		return io.Copy(&f.basicWriter, r)
 	}
@@ -118,27 +127,18 @@ func (f *httpFancyWriter) ReadFrom(r io.Reader) (int64, error) {
 	return rf.ReadFrom(r)
 }
 
-var _ http.CloseNotifier = &httpFancyWriter{}
-var _ http.Flusher = &httpFancyWriter{}
-var _ http.Hijacker = &httpFancyWriter{}
-var _ io.ReaderFrom = &httpFancyWriter{}
+var _ http.CloseNotifier = &fancyWriter{}
+var _ http.Flusher = &fancyWriter{}
+var _ http.Hijacker = &fancyWriter{}
+var _ io.ReaderFrom = &fancyWriter{}
 
-// http2FancyWriter is a HTTP2 writer that additionally satisfies http.CloseNotifier,
-// http.Flusher, and io.ReaderFrom. It exists for the common case
-// of wrapping the http.ResponseWriter that package http gives you, in order to
-// make the proxied object support the full method set of the proxied object.
-type http2FancyWriter struct {
+type flushWriter struct {
 	basicWriter
 }
 
-func (f *http2FancyWriter) CloseNotify() <-chan bool {
-	cn := f.basicWriter.ResponseWriter.(http.CloseNotifier)
-	return cn.CloseNotify()
-}
-func (f *http2FancyWriter) Flush() {
+func (f *flushWriter) Flush() {
 	fl := f.basicWriter.ResponseWriter.(http.Flusher)
 	fl.Flush()
 }
 
-var _ http.CloseNotifier = &http2FancyWriter{}
-var _ http.Flusher = &http2FancyWriter{}
+var _ http.Flusher = &flushWriter{}
diff --git a/middleware/wrap_writer17.go b/middleware/wrap_writer17.go
deleted file mode 100644
index c60df60..0000000
--- a/middleware/wrap_writer17.go
+++ /dev/null
@@ -1,34 +0,0 @@
-// +build go1.7,!go1.8
-
-package middleware
-
-import (
-	"io"
-	"net/http"
-)
-
-// NewWrapResponseWriter wraps an http.ResponseWriter, returning a proxy that allows you to
-// hook into various parts of the response process.
-func NewWrapResponseWriter(w http.ResponseWriter, protoMajor int) WrapResponseWriter {
-	_, cn := w.(http.CloseNotifier)
-	_, fl := w.(http.Flusher)
-
-	bw := basicWriter{ResponseWriter: w}
-
-	if protoMajor == 2 {
-		if cn && fl {
-			return &http2FancyWriter{bw}
-		}
-	} else {
-		_, hj := w.(http.Hijacker)
-		_, rf := w.(io.ReaderFrom)
-		if cn && fl && hj && rf {
-			return &httpFancyWriter{bw}
-		}
-	}
-	if fl {
-		return &flushWriter{bw}
-	}
-
-	return &bw
-}
diff --git a/middleware/wrap_writer18.go b/middleware/wrap_writer18.go
deleted file mode 100644
index 9233d8b..0000000
--- a/middleware/wrap_writer18.go
+++ /dev/null
@@ -1,41 +0,0 @@
-// +build go1.8
-
-package middleware
-
-import (
-	"io"
-	"net/http"
-)
-
-// NewWrapResponseWriter wraps an http.ResponseWriter, returning a proxy that allows you to
-// hook into various parts of the response process.
-func NewWrapResponseWriter(w http.ResponseWriter, protoMajor int) WrapResponseWriter {
-	_, cn := w.(http.CloseNotifier)
-	_, fl := w.(http.Flusher)
-
-	bw := basicWriter{ResponseWriter: w}
-
-	if protoMajor == 2 {
-		_, ps := w.(http.Pusher)
-		if cn && fl && ps {
-			return &http2FancyWriter{bw}
-		}
-	} else {
-		_, hj := w.(http.Hijacker)
-		_, rf := w.(io.ReaderFrom)
-		if cn && fl && hj && rf {
-			return &httpFancyWriter{bw}
-		}
-	}
-	if fl {
-		return &flushWriter{bw}
-	}
-
-	return &bw
-}
-
-func (f *http2FancyWriter) Push(target string, opts *http.PushOptions) error {
-	return f.basicWriter.ResponseWriter.(http.Pusher).Push(target, opts)
-}
-
-var _ http.Pusher = &http2FancyWriter{}
diff --git a/testdata/cert.pem b/testdata/cert.pem
deleted file mode 100644
index 71d285e..0000000
--- a/testdata/cert.pem
+++ /dev/null
@@ -1,19 +0,0 @@
------BEGIN CERTIFICATE-----
-MIIC/zCCAeegAwIBAgIRANioW0Re7DtpT4qZpJU1iK8wDQYJKoZIhvcNAQELBQAw
-EjEQMA4GA1UEChMHQWNtZSBDbzAeFw0xNjEyMzExNDU0MzBaFw0xNzEyMzExNDU0
-MzBaMBIxEDAOBgNVBAoTB0FjbWUgQ28wggEiMA0GCSqGSIb3DQEBAQUAA4IBDwAw
-ggEKAoIBAQDpFfOsaXDYlL+ektfsqGYrSAsoTbe7zqjpow9nqUU4PmLRu2YMaaW8
-fAoneUnJxsJw7ql38+VMpphZUOmOWvsO7uV/lfnTIQfTwllHDdgAR5A11d84Zy/y
-TiNIFJduuaPtEhQs1dxPhU7TG8sEfFRhBoUDPv473akeGPNkVU756RVBYM6rUc3b
-YygD0PXGsQ2obrImbYUyyHH5YClCvGl1No57n3ugLqSSfwbgR3/Gw7kkGKy0PMOu
-TuHuJnTEmofJPkqEyFRVMlIAtfqFqJUfDHTOuQGWIUPnjDg+fqTI9EPJ+pElBqDQ
-IqW93BY5XePMdrTQc1h6xkduDfuLeA7TAgMBAAGjUDBOMA4GA1UdDwEB/wQEAwIF
-oDATBgNVHSUEDDAKBggrBgEFBQcDATAMBgNVHRMBAf8EAjAAMBkGA1UdEQQSMBCC
-DmxvY2FsaG9zdDo3MDcyMA0GCSqGSIb3DQEBCwUAA4IBAQDnsWmZdf7209A/XHUe
-xoONCbU8jaYFVoA+CN9J+3CASzrzTQ4fh9RJdm2FZuv4sWnb5c5hDN7H/M/nLcb0
-+uu7ACBGhd7yACYCQm/z3Pm3CY2BRIo0vCCRioGx+6J3CPGWFm0vHwNBge0iBOKC
-Wn+/YOlTDth/M3auHYlr7hdFmf57U4V/5iTr4wiKxwM9yMPcVRQF/1XpPd7A0VqM
-nFSEfDpFjrA7MvT3DrRqQGqF/ZXxDbro2nyki3YG8FwgKlFNVN9w55zNiriQ+WNA
-uz86lKg1FTc+m/R/0CD//7+7mme28N813EPVdV83TgxWNrfvAIRazkHE7YxETry0
-BJDg
------END CERTIFICATE-----
\ No newline at end of file
diff --git a/testdata/key.pem b/testdata/key.pem
deleted file mode 100644
index f42ec5f..0000000
--- a/testdata/key.pem
+++ /dev/null
@@ -1,27 +0,0 @@
------BEGIN RSA PRIVATE KEY-----
-MIIEpAIBAAKCAQEA6RXzrGlw2JS/npLX7KhmK0gLKE23u86o6aMPZ6lFOD5i0btm
-DGmlvHwKJ3lJycbCcO6pd/PlTKaYWVDpjlr7Du7lf5X50yEH08JZRw3YAEeQNdXf
-OGcv8k4jSBSXbrmj7RIULNXcT4VO0xvLBHxUYQaFAz7+O92pHhjzZFVO+ekVQWDO
-q1HN22MoA9D1xrENqG6yJm2FMshx+WApQrxpdTaOe597oC6kkn8G4Ed/xsO5JBis
-tDzDrk7h7iZ0xJqHyT5KhMhUVTJSALX6haiVHwx0zrkBliFD54w4Pn6kyPRDyfqR
-JQag0CKlvdwWOV3jzHa00HNYesZHbg37i3gO0wIDAQABAoIBAFvqYDE5U1rVLctm
-tOeKcN/YhS3bl/zjvhCEUOrcAYPwdh+m+tMiRk1RzN9MISEE1GCcfQ/kiiPz/lga
-ZD/S+PYmlzH8/ouXlvKWzYYLm4ZgsinIsUIYzvuKfLdMB3uOkWpHmtUjcMGbHD57
-009tiAjK/WEOUkthWfOYe0KxsXczBn3PTAWZuiIkuA3RVWa7pCCFHUENkViP58wl
-Ky1hYKnunKPApRwuiC6qIT5ZOCSukdCCbkmRnj/x+P8+nsosu+1d85MNZb8uLRi0
-RzMmuOfOK2poDsrNHQX7itKlu7rzMJQc3+RauqIZovNe/BmSq+tYBLboXvUp18g/
-+VqKeEECgYEA/LaD1tJepzD/1lhgunFcnDjxsDJqLUpfR5eDMX1qhGJphuPBLOXS
-ushmVVjbVIn25Wxeoe4RYrZ6Tuu0FEJJgV44Lt42OOFgK2gyrCJpYmlxpRaw+7jc
-Dbp1Sh3/9VqMZjR/mQIzTnfOtS2n4Fk1Q53hdJn5Pn+uPMmMO4hF87sCgYEA7B4V
-BACsd6eqVxKkEMc72VLeYb0Ri0bl0FwbvIKXImppwA0tbMDmeA+6yhcRm23dhd5v
-cfNhJepRIzkM2CkhnazlsAbDoJPqb7/sbNzodtW1P0op7YIFYbrkcX4yOu9O1DNI
-Ij4PR8H1WcpPjhvr3q+iNO5agQX7bMQ1BnnJg8kCgYBA1tdm090DSrgpl81hqNpZ
-HucsDRNfAXkG1mIL3aDpzJJE0MTsrx7tW6Od/ElyHF/jp3V0WK/PQwCIpUMz+3n+
-nl0N8We6GmFhYb+2mLGvVVyaPgM04s5bG18ioCXfHtdtFcUzTfQ6CtVXeRpcnqbi
-7Ww+TY88sOfUouW/FIzWJwKBgQCsLauJhaw+fOc8I328NmywJzu+7g5TD9oZvHEF
-X/0xvYNr5rAPNANb3ayKHZRbURxOuEtwPtfCvEF6e+mf3y6COkgrumMBP5ue7cdM
-AzMJJQHMKxqz9TJTd+OJ10ptq4BCQTsCrVqbKxbs6RhmOnofoteX3Y/lsiULxXAd
-TsXh8QKBgQDQHosH8VoL7vIK+SqY5uoHAhMytSVNx4IaZZg4ho8oyjw12QXcidgV
-QJZQMdPEv8cAK78WcQdSthop+O/tu2cKLHyAmWmO3oU7gIQECui0aMXSqraO6Vde
-C5tqYlyLa7bHZS3AqrjRv9BRfwPKVkmBoYdA652rN/tE/K4UWsghnA==
------END RSA PRIVATE KEY-----
\ No newline at end of file
