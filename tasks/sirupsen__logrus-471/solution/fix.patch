diff --git a/README.md b/README.md
index 206c746..3823323 100644
--- a/README.md
+++ b/README.md
@@ -87,7 +87,8 @@ func init() {
   // Log as JSON instead of the default ASCII formatter.
   log.SetFormatter(&log.JSONFormatter{})
 
-  // Output to stdout instead of the default stderr, could also be a file.
+  // Output to stdout instead of the default stderr
+  // Can be any io.Writer, see below for File example
   log.SetOutput(os.Stdout)
 
   // Only log the warning severity or above.
@@ -138,7 +139,15 @@ var log = logrus.New()
 func main() {
   // The API for setting attributes is a little different than the package level
   // exported logger. See Godoc.
-  log.Out = os.Stderr
+  log.Out = os.Stdout
+
+  // You could set this to any `io.Writer` such as a file
+  // file, err := os.OpenFile("logrus.log", os.O_CREATE|os.O_WRONLY, 0666)
+  // if err == nil {
+  //  log.Out = file
+  // } else {
+  //  log.Info("Failed to log to file, using default stderr")
+  // }
 
   log.WithFields(logrus.Fields{
     "animal": "walrus",
diff --git a/examples/basic/basic.go b/examples/basic/basic.go
index a1623ec..ad703fc 100644
--- a/examples/basic/basic.go
+++ b/examples/basic/basic.go
@@ -2,6 +2,7 @@ package main
 
 import (
 	"github.com/Sirupsen/logrus"
+	// "os"
 )
 
 var log = logrus.New()
@@ -9,6 +10,14 @@ var log = logrus.New()
 func init() {
 	log.Formatter = new(logrus.JSONFormatter)
 	log.Formatter = new(logrus.TextFormatter) // default
+
+	// file, err := os.OpenFile("logrus.log", os.O_CREATE|os.O_WRONLY, 0666)
+	// if err == nil {
+	// 	log.Out = file
+	// } else {
+	// 	log.Info("Failed to log to file, using default stderr")
+	// }
+
 	log.Level = logrus.DebugLevel
 }
 
diff --git a/formatter_bench_test.go b/formatter_bench_test.go
index c6d290c..d948158 100644
--- a/formatter_bench_test.go
+++ b/formatter_bench_test.go
@@ -80,11 +80,14 @@ func BenchmarkLargeJSONFormatter(b *testing.B) {
 }
 
 func doBenchmark(b *testing.B, formatter Formatter, fields Fields) {
+	logger := New()
+
 	entry := &Entry{
 		Time:    time.Time{},
 		Level:   InfoLevel,
 		Message: "message",
 		Data:    fields,
+		Logger:  logger,
 	}
 	var d []byte
 	var err error
diff --git a/terminal_solaris.go b/terminal_solaris.go
index 943394c..f3d6f96 100644
--- a/terminal_solaris.go
+++ b/terminal_solaris.go
@@ -13,7 +13,7 @@ func IsTerminal(f io.Writer) bool {
 	var termios Termios
 	switch v := f.(type) {
 	case *os.File:
-		_, err := unix.IoctlGetTermios(int(f.Fd()), unix.TCGETA)
+		_, err := unix.IoctlGetTermios(int(v.Fd()), unix.TCGETA)
 		return err == nil
 	default:
 		return false
diff --git a/text_formatter.go b/text_formatter.go
index f75e13e..b4dffa1 100644
--- a/text_formatter.go
+++ b/text_formatter.go
@@ -5,6 +5,7 @@ import (
 	"fmt"
 	"sort"
 	"strings"
+	"sync"
 	"time"
 )
 
@@ -49,8 +50,8 @@ type TextFormatter struct {
 	DisableSorting bool
 
 	// Whether the logger's out is to a terminal
-	isTerminal         bool
-	terminalDetermined bool
+	isTerminal   bool
+	terminalOnce sync.Once
 }
 
 func (f *TextFormatter) Format(entry *Entry) ([]byte, error) {
@@ -71,10 +72,11 @@ func (f *TextFormatter) Format(entry *Entry) ([]byte, error) {
 
 	prefixFieldClashes(entry.Data)
 
-	if !f.terminalDetermined {
-		f.isTerminal = IsTerminal(entry.Logger.Out)
-		f.terminalDetermined = true
-	}
+	f.terminalOnce.Do(func() {
+		if entry.Logger != nil {
+			f.isTerminal = IsTerminal(entry.Logger.Out)
+		}
+	})
 
 	isColored := (f.ForceColors || f.isTerminal) && !f.DisableColors
 
