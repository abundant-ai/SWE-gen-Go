diff --git a/context.go b/context.go
index 7c66de1..dfb4985 100644
--- a/context.go
+++ b/context.go
@@ -49,8 +49,8 @@ func (c *Context) Socket() *websocket.Conn {
 }
 
 // P returns path parameter by index.
-func (c *Context) P(i int) (value string) {
-	l := len(c.pnames)
+func (c *Context) P(i uint8) (value string) {
+	l := uint8(len(c.pnames))
 	if i <= l {
 		value = c.pvalues[i]
 	}
diff --git a/examples/website/public/favicon.ico b/examples/website/public/favicon.ico
old mode 100644
new mode 100755
diff --git a/router.go b/router.go
index f11d4bf..fcb21d3 100644
--- a/router.go
+++ b/router.go
@@ -4,9 +4,9 @@ import "net/http"
 
 type (
 	Router struct {
-		trees  [21]*node
-		routes []Route
-		echo   *Echo
+		trees    map[string]*node
+		routes   []Route
+		echo     *Echo
 	}
 	node struct {
 		typ      ntype
@@ -30,12 +30,12 @@ const (
 
 func NewRouter(e *Echo) (r *Router) {
 	r = &Router{
-		//		trees:  make(map[string]*node),
+		trees:  make(map[string]*node),
 		routes: []Route{},
 		echo:   e,
 	}
 	for _, m := range methods {
-		r.trees[r.treeIndex(m)] = &node{
+		r.trees[m] = &node{
 			prefix:   "",
 			children: children{},
 		}
@@ -81,21 +81,13 @@ func (r *Router) insert(method, path string, h HandlerFunc, t ntype, pnames []st
 		*e.maxParam = l
 	}
 
-	cn := r.trees[r.treeIndex(method)] // Current node as root
+	cn := r.trees[method] // Current node as root
 	search := path
 
 	for {
 		sl := len(search)
 		pl := len(cn.prefix)
-		l := 0
-
-		// LCP
-		max := pl
-		if sl < max {
-			max = sl
-		}
-		for ; l < max && search[l] == cn.prefix[l]; l++ {
-		}
+		l := lcp(search, cn.prefix)
 
 		if l == 0 {
 			// At root node
@@ -110,18 +102,16 @@ func (r *Router) insert(method, path string, h HandlerFunc, t ntype, pnames []st
 		} else if l < pl {
 			// Split node
 			n := newNode(cn.typ, cn.prefix[l:], cn, cn.children, cn.handler, cn.pnames, cn.echo)
+			cn.children = children{n} // Add to parent
 
 			// Reset parent node
 			cn.typ = stype
 			cn.label = cn.prefix[0]
 			cn.prefix = cn.prefix[:l]
-			cn.children = nil
 			cn.handler = nil
 			cn.pnames = nil
 			cn.echo = nil
 
-			cn.addChild(n)
-
 			if l == sl {
 				// At parent node
 				cn.typ = t
@@ -131,11 +121,11 @@ func (r *Router) insert(method, path string, h HandlerFunc, t ntype, pnames []st
 			} else {
 				// Create child node
 				n = newNode(t, search[l:], cn, nil, h, pnames, e)
-				cn.addChild(n)
+				cn.children = append(cn.children, n)
 			}
 		} else if l < sl {
 			search = search[l:]
-			c := cn.findChildWithLabel(search[0])
+			c := cn.findChild(search[0])
 			if c != nil {
 				// Go deeper
 				cn = c
@@ -143,7 +133,7 @@ func (r *Router) insert(method, path string, h HandlerFunc, t ntype, pnames []st
 			}
 			// Create child node
 			n := newNode(t, search, cn, nil, h, pnames, e)
-			cn.addChild(n)
+			cn.children = append(cn.children, n)
 		} else {
 			// Node already exists
 			if h != nil {
@@ -169,47 +159,56 @@ func newNode(t ntype, pre string, p *node, c children, h HandlerFunc, pnames []s
 	}
 }
 
-func (n *node) addChild(c *node) {
-	n.children = append(n.children, c)
+func (n *node) findChild(l byte) *node {
+	for _, c := range n.children {
+		if c.label == l {
+			return c
+		}
+	}
+	return nil
 }
 
-func (n *node) findChild(l byte, t ntype) *node {
+func (n *node) findSchild(l byte) *node {
 	for _, c := range n.children {
-		if c.label == l && c.typ == t {
+		if c.label == l && c.typ == stype {
 			return c
 		}
 	}
 	return nil
 }
 
-func (n *node) findChildWithLabel(l byte) *node {
+func (n *node) findPchild() *node {
 	for _, c := range n.children {
-		if c.label == l {
+		if c.typ == ptype {
 			return c
 		}
 	}
 	return nil
 }
 
-func (n *node) findChildWithType(t ntype) *node {
+func (n *node) findMchild() *node {
 	for _, c := range n.children {
-		if c.typ == t {
+		if c.typ == mtype {
 			return c
 		}
 	}
 	return nil
 }
 
-func (r *Router) treeIndex(method string) uint8 {
-	if method[0] == 'P' {
-		return method[0]%10 + method[1] - 65
-	} else {
-		return method[0] % 10
+// Length of longest common prefix
+func lcp(a, b string) (i int) {
+	max := len(a)
+	l := len(b)
+	if l < max {
+		max = l
 	}
+	for ; i < max && a[i] == b[i]; i++ {
+	}
+	return
 }
 
 func (r *Router) Find(method, path string, ctx *Context) (h HandlerFunc, e *Echo) {
-	cn := r.trees[r.treeIndex(method)] // Current node as root
+	cn := r.trees[method] // Current node as root
 	search := path
 
 	var (
@@ -236,16 +235,8 @@ func (r *Router) Find(method, path string, ctx *Context) (h HandlerFunc, e *Echo
 		l := 0  // LCP length
 
 		if cn.label != ':' {
-			sl := len(search)
 			pl = len(cn.prefix)
-
-			// LCP
-			max := pl
-			if sl < max  {
-				max = sl
-			}
-			for ; l < max && search[l] == cn.prefix[l]; l++ {
-			}
+			l = lcp(search, cn.prefix)
 		}
 
 		if l == pl {
@@ -266,7 +257,7 @@ func (r *Router) Find(method, path string, ctx *Context) (h HandlerFunc, e *Echo
 
 		if search == "" {
 			// TODO: Needs improvement
-			if cn.findChildWithType(mtype) == nil {
+			if cn.findMchild() == nil {
 				continue
 			}
 			// Empty value
@@ -274,7 +265,7 @@ func (r *Router) Find(method, path string, ctx *Context) (h HandlerFunc, e *Echo
 		}
 
 		// Static node
-		c = cn.findChild(search[0], stype)
+		c = cn.findSchild(search[0])
 		if c != nil {
 			// Save next
 			if cn.label == '/' {
@@ -288,7 +279,7 @@ func (r *Router) Find(method, path string, ctx *Context) (h HandlerFunc, e *Echo
 
 		// Param node
 	Param:
-		c = cn.findChildWithType(ptype)
+		c = cn.findPchild()
 		if c != nil {
 			// Save next
 			if cn.label == '/' {
@@ -308,15 +299,13 @@ func (r *Router) Find(method, path string, ctx *Context) (h HandlerFunc, e *Echo
 
 		// Match-any node
 	MatchAny:
-		//		c = cn.getChild()
-		c = cn.findChildWithType(mtype)
+		c = cn.findMchild()
 		if c != nil {
 			cn = c
 			ctx.pvalues[0] = search
 			search = "" // End search
 			continue
 		}
-
 		// Not found
 		return
 	}
diff --git a/router_test.go b/router_test.go
index caaadd7..4370163 100644
--- a/router_test.go
+++ b/router_test.go
@@ -10,7 +10,7 @@ import (
 )
 
 var (
-	api = []Route{
+	api     = []Route{
 		// OAuth Authorizations
 		{"GET", "/authorizations", nil},
 		{"GET", "/authorizations/:id", nil},
@@ -520,6 +520,11 @@ func TestRouterAPI(t *testing.T) {
 
 	for _, route := range api {
 		r.Add(route.Method, route.Path, func(c *Context) error {
+			for i, n := range c.pnames {
+				if assert.NotEmpty(t, n) {
+					assert.Equal(t, ":"+n, c.P(uint8(i)))
+				}
+			}
 			return nil
 		}, e)
 	}
@@ -527,11 +532,6 @@ func TestRouterAPI(t *testing.T) {
 	for _, route := range api {
 		h, _ := r.Find(route.Method, route.Path, c)
 		if assert.NotNil(t, h) {
-			for i, n := range c.pnames {
-				if assert.NotEmpty(t, n) {
-					assert.Equal(t, ":"+n, c.P(i))
-				}
-			}
 			h(c)
 		}
 	}
diff --git a/website/docs/guide.md b/website/docs/guide.md
index f6a694d..73d0560 100644
--- a/website/docs/guide.md
+++ b/website/docs/guide.md
@@ -77,7 +77,7 @@ types of handlers.
 ### Path parameter
 
 Request path parameters can be extracted either by name `Echo.Context.Param(name string) string`
-or by index `Echo.Context.P(i int) string`. Getting parameter by index gives a
+or by index `Echo.Context.P(i uint8) string`. Getting parameter by index gives a
 slightly better performance.
 
 ```go
