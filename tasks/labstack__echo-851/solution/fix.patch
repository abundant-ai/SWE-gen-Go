diff --git a/middleware/compress.go b/middleware/compress.go
index 3d4a762..cfe8610 100644
--- a/middleware/compress.go
+++ b/middleware/compress.go
@@ -67,14 +67,17 @@ func GzipWithConfig(config GzipConfig) echo.MiddlewareFunc {
 			res := c.Response()
 			res.Header().Add(echo.HeaderVary, echo.HeaderAcceptEncoding)
 			if strings.Contains(c.Request().Header.Get(echo.HeaderAcceptEncoding), gzipScheme) {
+				res.Header().Add(echo.HeaderContentEncoding, gzipScheme) // issue #806
 				rw := res.Writer
 				w, err := gzip.NewWriterLevel(rw, config.Level)
 				if err != nil {
 					return err
 				}
 				defer func() {
-
 					if res.Size == 0 {
+						if res.Header().Get(echo.HeaderContentEncoding) == gzipScheme {
+							res.Header().Del(echo.HeaderContentEncoding)
+						}
 						// We have to reset response to it's pristine state when
 						// nothing is written to body or error is returned.
 						// See issue #424, #407.
@@ -92,8 +95,8 @@ func GzipWithConfig(config GzipConfig) echo.MiddlewareFunc {
 }
 
 func (w *gzipResponseWriter) WriteHeader(code int) {
-	if code != http.StatusNoContent { // Issue #489
-		w.ResponseWriter.Header().Set(echo.HeaderContentEncoding, gzipScheme)
+	if code == http.StatusNoContent { // Issue #489
+		w.ResponseWriter.Header().Del(echo.HeaderContentEncoding)
 	}
 	w.ResponseWriter.WriteHeader(code)
 }
diff --git a/middleware/testdata/compress/data b/middleware/testdata/compress/data
new file mode 100644
index 0000000..0aa6fb5
--- /dev/null
+++ b/middleware/testdata/compress/data
@@ -0,0 +1 @@
+test data
\ No newline at end of file
