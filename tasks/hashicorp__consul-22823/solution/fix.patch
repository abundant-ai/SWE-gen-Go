diff --git a/agent/consul/state/catalog.go b/agent/consul/state/catalog.go
index 3317658f0f..b24929f101 100644
--- a/agent/consul/state/catalog.go
+++ b/agent/consul/state/catalog.go
@@ -1251,8 +1251,7 @@ func addIPOffset(b net.IP) (net.IP, error) {
 // Returns the sum modulo 2^128 as a new IPv6 address.
 func addIPv6Offset(a, b net.IP) (net.IP, error) {
 	a4 := a.To4()
-	b4 := b.To4()
-	if a4 != nil || b4 != nil {
+	if a4 != nil {
 		return nil, errors.New("ip is not valid IPv6")
 	}
 	a16 := a.To16()
diff --git a/command/connect/redirecttraffic/redirect_traffic.go b/command/connect/redirecttraffic/redirect_traffic.go
index dbeb015929..d48a3658e1 100644
--- a/command/connect/redirecttraffic/redirect_traffic.go
+++ b/command/connect/redirecttraffic/redirect_traffic.go
@@ -10,6 +10,7 @@ import (
 	"strconv"
 
 	"github.com/go-viper/mapstructure/v2"
+	"github.com/hashicorp/consul/agent/netutil"
 	"github.com/hashicorp/consul/api"
 	"github.com/hashicorp/consul/command/flags"
 	"github.com/hashicorp/consul/sdk/iptables"
@@ -75,7 +76,6 @@ func (c *cmd) init() {
 		"Additional user ID to exclude from traffic redirection. May be provided multiple times.")
 	c.flags.StringVar(&c.netNS, "netns", "", "The network namespace where traffic redirection rules should apply."+
 		"This must be a path to the network namespace, e.g. /var/run/netns/foo.")
-	c.flags.BoolVar(&c.dualStack, "dual-stack", false, "To setup dual-stack based routing")
 
 	c.http = &flags.HTTPFlags{}
 	flags.Merge(c.flags, c.http.ClientFlags())
@@ -111,7 +111,18 @@ func (c *cmd) Run(args []string) int {
 		return 1
 	}
 
-	err = iptables.Setup(cfg, c.dualStack)
+	ac, err := c.http.APIConfig()
+	if err != nil {
+		c.UI.Error(fmt.Sprintf("error creating Consul API client: %s", err.Error()))
+		return 1
+	}
+	ds, err := netutil.IsDualStack(ac, false)
+	if err != nil {
+		c.UI.Error(fmt.Sprintf("error determining if agent is running in dual-stack mode: %s", err.Error()))
+		return 1
+	}
+
+	err = iptables.Setup(cfg, ds)
 	if err != nil {
 		c.UI.Error(fmt.Sprintf("Error setting up traffic redirection rules: %s", err.Error()))
 		return 1
diff --git a/command/flags/http.go b/command/flags/http.go
index 009c26629c..c2e7a4fd44 100644
--- a/command/flags/http.go
+++ b/command/flags/http.go
@@ -159,6 +159,13 @@ func (f *HTTPFlags) APIClient() (*api.Client, error) {
 	return api.NewClient(c)
 }
 
+func (f *HTTPFlags) APIConfig() (*api.Config, error) {
+	c := api.DefaultConfig()
+	f.MergeOntoConfig(c)
+
+	return c, nil
+}
+
 func (f *HTTPFlags) MergeOntoConfig(c *api.Config) {
 	f.address.Merge(&c.Address)
 	f.token.Merge(&c.Token)
